/*
 * (c) Copyright 2018 QiYan. All Rights Reserved.
 * **/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"function"==typeof define&&define.amd?define(t):"function"==typeof define?define(t):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=t():e.easyPoped=t()}("undefined"!=typeof window?window:void 0,function(){function e(e,t,n){var o=null,s=1e3,i=[];switch(!0){case arguments.length<1:throw new Error("msg方法参数至少需要一个输出内容参数！");case 1==arguments.length:if("string"!=typeof e&&isNaN(e))throw new TypeError("msg方法参数类型不正确！参数必须为字符串类型或者是数值类型");o=e;break;case 2==arguments.length:if("string"!=typeof e&&isNaN(e)||"number"!=typeof t){if("string"!=typeof e&&isNaN(e)||"[object Array]"!={}.toString.call(t))throw new TypeError("msg方法参数类型不正确！第一个应为字符串或数值，第二个如果设置时间应为数值，偏移量则为数组");o=e,i=t}else o=e,s=t;break;case 3==arguments.length:if("string"!=typeof e&&isNaN(e)||"number"!=typeof t||"[object Array]"!={}.toString.call(n))throw new TypeError("msg方法参数类型不正确！第一个应为字符串，第二个应为数字,第三个应为数组！");o=e,s=t,i=n}var l=document.createElement("div"),c="popedMsg"+(new Date).getTime();l.id=c,l.className=r.TIPS_OUT_CLASS,p.push(c);var d=document.createElement("div"),u=document.createTextNode(o);d.className=r.TIPS_IN_CLASS,d.appendChild(u),l.appendChild(d);var f=document.documentElement.offsetWidth||document.body.offsetWidth,N=window.innerHeight;if(i.length?1==i.length?(l.style.top=isNaN(i[0])?i[0]:i[0]+"px",l.style.left=(f-352)/2+"px"):(l.style.top=isNaN(i[0])?i[0]:i[0]+"px",l.style.left=isNaN(i[1])?i[1]:i[1]+"px"):(l.style.top=(N-54)/2+"px",l.style.left=(f-352)/2+"px"),0!=s){var y=setTimeout(function(){a(c),m.splice(m.indexOf(y),1)},s);m.push(y)}return document.body.appendChild(l),p.length>1&&(clearTimeout(m[0]),m.splice(m.indexOf(m[0]),1),a(p[0])),c}function t(e){var t={title:e.title||"弹出层",url:e.url||"",content:e.content||"",icon:e.icon||0,space:e.space||[],style:e.style,closeBtn:e.closeBtn,btns:e.btns||0,btnsRML:e.btnsRML,outClose:e.outClose,btnsFn:e.btnsFn,closeFn:e.closeFn||function(){}},n=null;switch(!0){case""!=t.content:n=N.content(t);break;case""!=t.url:n=N.iframe(t);break;default:throw new Error("easyUtil_poped:没有找到可以打开的页面！")}return n}function n(e){return t({title:e.title||"弹出层",url:e.url||"",space:e.space||[],style:e.style||1,closeBtn:0==e.closeBtn?0:e.closeBtn||1,outClose:e.outClose||!0,closeFn:e.closeFn})}function o(e){return t({title:e.title,content:e.content||"提示内容",space:["20em","13em"],style:e.style,icon:0==e.icon?0:e.icon||2,closeBtn:0==e.closeBtn?0:e.closeBtn||1,btns:[e.btn||"确定"],btnsRML:e.btnsRML||"r",outClose:e.outClose||!1,btnsFn:[e.btnFn||function(){}]})}function s(e){return t({title:e.title,content:e.content||"提示内容",space:["20em","13em"],style:e.style,icon:0==e.icon?0:e.icon||4,closeBtn:0==e.closeBtn?0:e.closeBtn||1,btns:[e.btn1||"确定",e.btn2||"取消"],btnsRML:e.btnsRML||"r",outClose:e.outClose||!1,btnsFn:[e.btn1Fn||function(){},e.btn2Fn||function(){}]})}function a(e){try{document.body.removeChild(document.querySelector("#"+e)),e.indexOf("Msg")>0?p.splice(p.indexOf(e),1):u.splice(u.indexOf(e),1)}catch(e){console.log("当前弹出层已关闭")}}function i(){var e=document.body;f.disable();for(var t=u.length;t--;)e.removeChild(document.querySelector("#"+u[t]));u=[];for(var n=p.length;n--;)e.removeChild(document.querySelector("#"+p[n]));p=[]}function l(e){return document.createElement(e)}function c(e){return document.createTextNode(e)}function d(e,t){var n=e.offsetWidth,o=e.offsetHeight,s=t.offsetWidth,a=t.offsetHeight;t.style.top=(o-a)/2+"px",t.style.left=(n-s)/2+"px"}var r={CLOSEID:"easyUtilPopedCloseBtn",IFRAMEID:"easyUtilPopedIframe",TITLEID:"easyUtilPopedTitle",TIPS_OUT_CLASS:"easyUtil-poped-Tips-out",TIPS_IN_CLASS:"easyUtil-poped-Tips-in",SHADE:"easyUtil-poped-ShadeBody",OUT:"easyUtil-poped-out",OUT_2:"easyUtil-poped-out2",ICON:"easyUtil-poped-icon",CLOSE_1:"easyUtil-poped-close1",CLOSE_2:"easyUtil-poped-close2",WARNNING:"easyUtil-poped-warnning",RIGHT:"easyUtil-poped-right",WRONG:"easyUtil-poped-wrong",REQUIRE:"easyUtil-poped-require",BTNLEFT:"easyUtil-poped-btns-left",BTNMIDDLE:"easyUtil-poped-btns-middle",TITLE:"easyUtil-poped-title",TITLE_2:"easyUtil-poped-title2",CONTENT:"easyUtil-poped-content",CONTENT_2:"easyUtil-poped-content2",INNER_CONTENT:"easyUtil-poped-inner-content",IFRAME:"easyUtil-poped-iframe",IFRAME_2:"easyUtil-poped-iframe2",BTNS:"easyUtil-poped-btns",BTNS_2:"easyUtil-poped-btns2",BTN1:"easyUtil-poped-btns-btn1",BTN1_2:"easyUtil-poped-btns-btn1-2",BTN2:"easyUtil-poped-btns-btn2",BTN2_2:"easyUtil-poped-btns-btn2-2"},p=[],u=[],m=[],f=function(){function e(e){e=b.getEvent(e);var s=b.getEventTarget(e);switch(e.type){case"mousedown":t=document.querySelector("."+r.OUT),t.contains(s)&&s.id==r.TITLEID?(n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop):t=null;break;case"mousemove":null!==t&&(t.style.left=e.clientX-n+"px",t.style.top=e.clientY-o+"px");break;case"mouseup":t=null}}var t=null,n=0,o=0;return{enable:function(){b.initEvent(document,"mousedown",e),b.initEvent(document,"mousemove",e),b.initEvent(document,"mouseup",e)},disable:function(){b.removeEvent(document,"mousedown",e),b.removeEvent(document,"mousemove",e),b.removeEvent(document,"mouseup",e)}}}(),N={basic:function(e){var t="poped"+(new Date).getTime(),n=l("div"),o=l("div"),s=l("div"),a=e.space,i=l("div"),d=c(e.title);switch(u.push(t),y.option=e,n.id=t,n.className=r.SHADE,o.className=r.OUT,s.className=r.TITLE,s.id=r.TITLEID,i.id=r.CLOSEID,!0){case 1==e.closeBtn:i.className=r.ICON+" "+r.CLOSE_1;break;case 2==e.closeBtn:i.className=r.ICON+" "+r.CLOSE_2}return a.length&&(1==a.length?o.style.width=isNaN(a[0])?a[0]:a[0]+"px":(o.style.width=isNaN(a[0])?a[0]:a[0]+"px",o.style.height=isNaN(a[1])?a[1]:a[1]+"px")),2==e.style&&(o.className+=" "+r.OUT_2,s.className+=" "+r.TITLE_2),s.appendChild(d),s.appendChild(i),o.appendChild(s),e.outClose?b.initEvent(n,"click",y.shadeClose):b.initEvent(n,"click",y.btnClose),f.enable(),y.shade=n,{title:s,out:o,shade:n}},iframe:function(e){var t=N.basic(e),n=t.out,o=t.shade.id,s=l("iframe");return s.id=r.IFRAMEID,s.className=r.IFRAME,2==e.style&&(s.className+=" "+r.IFRAME_2),s.src=e.url,n.appendChild(s),t.shade.appendChild(n),document.body.appendChild(t.shade),d(t.shade,n),u.length>1&&a(u[0]),o},content:function(e){var t=N.basic(e),n=l("div"),o=l("div"),s=c(e.content),i=l("div"),p=null,m=null,f=t.out,y=t.shade.id,b=l("div");switch(n.id="easyUtilpopedContent",n.className=r.CONTENT,o.className=r.INNER_CONTENT,i.id="easyUtilpopedbtns",i.className=r.BTNS,!0){case 2==e.icon:b.className=r.ICON+" "+r.RIGHT;break;case 4==e.icon:b.className=r.ICON+" "+r.REQUIRE;break;case 3==e.icon:b.className=r.ICON+" "+r.WRONG;break;case 1==e.icon:b.className=r.ICON+" "+r.WARNNING}switch(!0){case"r"==e.btnsRML:break;case"l"==e.btnsRML:i.className+=" "+r.BTNLEFT;break;case"m"==e.btnsRML:i.className+=" "+r.BTNMIDDLE}switch(!0){case 1==e.btns.length:p=l("button"),p.className=r.BTN1,p.innerHTML=e.btns[0];break;case 2==e.btns.length:p=l("button"),p.className=r.BTN1,p.innerHTML=e.btns[0],m=l("button"),m.className=r.BTN2,m.innerHTML=e.btns[1]}return 2==e.style&&(n.className+=" "+r.CONTENT_2,i.className+=" "+r.BTNS_2,p&&(p.className+=" "+r.BTN1_2),m&&(m.className+=" "+r.BTN2_2)),p&&i.appendChild(p),m&&i.appendChild(m),o.appendChild(b),o.appendChild(s),n.appendChild(o),f.appendChild(n),f.appendChild(i),t.shade.appendChild(f),document.body.appendChild(t.shade),d(t.shade,f),u.length>1&&a(u[0]),y}},y={option:null,shade:null,target:function(e){return b.stopPropagation(e),e=b.getEvent(e),b.getEventTarget(e)},closeShade:function(e){y.option.closeFn(),y.option.outClose?b.removeEvent(y.shade,"click",y.shadeClose):b.removeEvent(y.shade,"click",y.btnClose),f.disable(),a(y.shade.id),y.option=null,y.shade=null},btnEvent:function(e){switch(!0){case e.className.indexOf(r.BTN1)>-1:y.option.btnsFn[0](),y.closeShade(e);break;case e.className.indexOf(r.BTN2)>-1:y.option.btnsFn[1](),y.closeShade(e)}},shadeClose:function(e){var t=y.target(e);switch(!0){case t.id==r.CLOSEID:y.closeShade(t);break;case"button"==t.tagName.toLowerCase():y.btnEvent(t);break;case t.id==y.shade.id:y.closeShade(t)}},btnClose:function(e){var t=y.target(e);switch(!0){case t.id==r.CLOSEID:y.closeShade(t);break;case"button"==t.tagName.toLowerCase():y.btnEvent(t)}}},b={initEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},getEvent:function(e){return e||window.event},getEventTarget:function(e){return e.target||e.srcElement},getCharCode:function(e){return"number"==typeof e.charCode?e.charCode:e.keyCode},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},removeEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}};return{msg:e,open:n,alert:o,confirm:s,closeMsg:a,close:i}});